version: v1
# buff plugins https://buf.build/plugins
plugins:
  # generate go structs for protocol buffer defination
  - plugin: buf.build/protocolbuffers/go
    out: ./
    opt:
      - paths=source_relative
  # generate gRPC stubs in golang
  - plugin: buf.build/grpc/go:v1.3.0
    out: ./
    opt:
      - paths=source_relative
      - require_unimplemented_servers=false
  # generate reverse proxy from protocol definations
  - plugin: buf.build/grpc-ecosystem/gateway:v2.15.2
    out: ./
    opt:
      - paths=source_relative
      - generate_unbound_methods=true
      - allow_delete_body=true
  # generate openapi documentation for api
  - plugin: buf.build/grpc-ecosystem/openapiv2:v2.15.2
    out: ./
    opt: 
      - allow_delete_body=true
  - plugin: buf.build/grpc/web
    out: ./
    opt:
      - mode=grpcweb
      - import_style=typescript
  - plugin: buf.build/protocolbuffers/js
    out: ./
    opt:
      - import_style=commonjs,binary
    revision: 1
